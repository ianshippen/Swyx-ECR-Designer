<?xml version="1.0" encoding="UTF-8" standalone="yes"?><CallFlow><Node><NodeNumber>0</NodeNumber><XPos>10</XPos><YPos>10</YPos><NodeType>SIBB_Start</NodeType><Title>Start</Title><Data /><Outputs><Output><Name>Go</Name><NextNode>4</NextNode><Visible>True</Visible></Output></Outputs></Node><Node><NodeNumber>1</NodeNumber><XPos>170</XPos><YPos>10</YPos><NodeType>SIBB_OnDisconnect</NodeType><Title>OnDisconnect</Title><Data /><Outputs><Output><Name>On Disconnect</Name><NextNode>3</NextNode><Visible>True</Visible></Output></Outputs></Node><Node><NodeNumber>2</NodeNumber><XPos>1362</XPos><YPos>452</YPos><NodeType>SIBB_Skip</NodeType><Title>Skip</Title><Data /><Outputs /></Node><Node><NodeNumber>3</NodeNumber><XPos>1357</XPos><YPos>127</YPos><NodeType>SIBB_Done</NodeType><Title>Done</Title><Data /><Outputs /></Node><Node><NodeNumber>4</NodeNumber><XPos>335</XPos><YPos>108</YPos><NodeType>SIBB_VBScript</NodeType><Title>All Call To Queue</Title><Data>AddCallToQueue 0, $queueId, ""





</Data><Outputs><Output><Name>Default</Name><NextNode>5</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 1</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 2</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>5</NodeNumber><XPos>343</XPos><YPos>402</YPos><NodeType>SIBB_PlayAnnouncement</NodeType><Title>Play Announcement</Title><Data>cf_hold.wav</Data><Outputs><Output><Name>Continue</Name><NextNode>6</NextNode><Visible>True</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>6</NodeNumber><XPos>14</XPos><YPos>222</YPos><NodeType>SIBB_VBScript</NodeType><Title>Top of queue ?</Title><Data>lastAnnouncementTime = Now()
myUseExit = GetPositionInQueue(0)

If myUseExit &gt; 1 Then myUseExit = 1
If myUseExit = -1 Then myUseExit = 2





</Data><Outputs><Output><Name>Yes</Name><NextNode>7</NextNode><Visible>True</Visible></Output><Output><Name>No</Name><NextNode>11</NextNode><Visible>True</Visible></Output><Output><Name>Left Queue</Name><NextNode>-1</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>7</NodeNumber><XPos>173</XPos><YPos>225</YPos><NodeType>SIBB_VBScript</NodeType><Title>Target free ?</Title><Data>IsAgentFree("Team 1")




</Data><Outputs><Output><Name>True</Name><NextNode>8</NextNode><Visible>True</Visible></Output><Output><Name>False</Name><NextNode>11</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 2</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>8</NodeNumber><XPos>356</XPos><YPos>226</YPos><NodeType>SIBB_VBScript</NodeType><Title>State = RINGING</Title><Data>ChangeQueueState 0, "Ringing"
IncRings 0





</Data><Outputs><Output><Name>Default</Name><NextNode>9</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 1</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 2</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>9</NodeNumber><XPos>566</XPos><YPos>225</YPos><NodeType>SIBB_Connect</NodeType><Title>Connect  to target</Title><Data>Team 1,10</Data><Outputs><Output><Name>Connected</Name><NextNode>10</NextNode><Visible>True</Visible></Output><Output><Name>No Answer</Name><NextNode>17</NextNode><Visible>True</Visible></Output><Output><Name>Busy</Name><NextNode>14</NextNode><Visible>True</Visible></Output><Output><Name>Not Available</Name><NextNode>14</NextNode><Visible>True</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>10</NodeNumber><XPos>781</XPos><YPos>225</YPos><NodeType>SIBB_VBScript</NodeType><Title>Flag call</Title><Data>ChangeQueueState 0, "Answered"





</Data><Outputs><Output><Name>Default</Name><NextNode>3</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 1</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 2</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>11</NodeNumber><XPos>15</XPos><YPos>408</YPos><NodeType>SIBB_Hold</NodeType><Title>Hold</Title><Data>*hold*</Data><Outputs><Output><Name>Continue</Name><NextNode>12</NextNode><Visible>True</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>12</NodeNumber><XPos>173</XPos><YPos>406</YPos><NodeType>SIBB_VBScript</NodeType><Title>VB Script</Title><Data>ChangeQueueState 0, ""

Do While True
    If DateDiff("s", lastAnnouncementTime, Now()) &gt;= positionRefreshTimeSeconds Then
        myUseExit = 1
        Exit Do
    End If

    ' Check if we are now top of the queue ?
    Select Case GetPositionInQueue(0)
	Case -1
	    myUseExit = 2

	Case 0
	    myUseExit = 0

	Case Else
	    myUseExit = 1
    End Select

    If myUseExit = 2 Then Exit Do

    If myUseExit = 0 Then
        If IsAgentFree("Team 1") Then
            ' Yes. Use Exit 0, and exit now
	    Exit Do
        End If
    End If

    ' Sleep for 2 seconds
    PBXScript.Sleep 2000
Loop


</Data><Outputs><Output><Name>Top Of Queue</Name><NextNode>8</NextNode><Visible>True</Visible></Output><Output><Name>Loop</Name><NextNode>5</NextNode><Visible>True</Visible></Output><Output><Name>Left Queue</Name><NextNode>13</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>13</NodeNumber><XPos>617</XPos><YPos>473</YPos><NodeType>SIBB_VBScript</NodeType><Title>Remove from queue</Title><Data>RemoveCallFromQueue 0



</Data><Outputs><Output><Name>Default</Name><NextNode>2</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 1</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 2</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>14</NodeNumber><XPos>480</XPos><YPos>633</YPos><NodeType>SIBB_VBScript</NodeType><Title>State = QUEUEING</Title><Data>ChangeQueueState 0, "Queueing"




</Data><Outputs><Output><Name>Default</Name><NextNode>15</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 1</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 2</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>15</NodeNumber><XPos>653</XPos><YPos>626</YPos><NodeType>SIBB_Hold</NodeType><Title>Hold</Title><Data>*hold*</Data><Outputs><Output><Name>Continue</Name><NextNode>16</NextNode><Visible>True</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>16</NodeNumber><XPos>869</XPos><YPos>621</YPos><NodeType>SIBB_Sleep</NodeType><Title>Sleep</Title><Data>1000</Data><Outputs><Output><Name>Awake</Name><NextNode>12</NextNode><Visible>True</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node><Node><NodeNumber>17</NodeNumber><XPos>750</XPos><YPos>344</YPos><NodeType>SIBB_VBScript</NodeType><Title>State = Queueing</Title><Data>ChangeQueueState 0, "Queueing"



</Data><Outputs><Output><Name>Default</Name><NextNode>11</NextNode><Visible>True</Visible></Output><Output><Name>Return Code 1</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 2</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 3</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 4</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 5</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 6</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 7</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 8</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Return Code 9</Name><NextNode>-1</NextNode><Visible>False</Visible></Output><Output><Name>Disconnected</Name><NextNode>-1</NextNode><Visible>False</Visible></Output></Outputs></Node></CallFlow>